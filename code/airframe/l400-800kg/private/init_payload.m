% 农药重量kg
db.payload.init_mass = 450;

% 喷洒速度kg/s
db.payload.spray_speed = 0;



%% 计算农药重心和转动惯量
%
% 重心和转动惯量，随俯仰角和农药质量进行插值
%
% Gx,Gy,Gz：农药重心位置（构型坐标系，后右上）
% IoxG,IoyG,IozG,IxyG,IxzG,IyzG：以农药重心为原点计算的惯性张量（后右上）
% Px,Py,Pz：参考重心位置（构型坐标系，后右上）
% IoxP,IoyP,IozP,IxyP,IxzP,IyzP：以参考重心为原点计算的惯性张量（后右上）
%
% Catia在计算Ixy，Ixz，Iyz时已经添加了负号，但是solidworks是没有添加负号
%
tmp = [
    % 俯仰角     质量[kg]               Gx[mm]               Gy[mm]               Gz[mm]               IoxG[kgxm2]          IoyG[kgxm2]          IozG[kgxm2]          IxyG[kgxm2]          IxzG[kgxm2]          IyzG[kgxm2]          IoxP[kgxm2]          IoyP[kgxm2]          IozP[kgxm2]          IxyP[kgxm2]          IxzP[kgxm2]          IyzP[kgxm2]          Px[mm]               Py[mm]               Pz[mm]
    -5    449.847    2181.681    -0.000254651    -226.108    30.417    68.527    83.648    0    3.758    0    42.093    87.381    90.826     -1.447e-005         -5.397     -1.846e-005         2308    0    -65
    -5    318.01    2170.077    -0.000243467    -286.859    18.649    43.483    55.455    0    2.729    0    34.302    65.186    61.505     -1.068e-005         -7.002     -1.718e-005         2308    0    -65
    -5    186.891    2149.53    -0.000218275    -351.755    9.051    20.946    27.732    0    1.592    0    24.418    41.007    32.426     -6.465e-006         -6.9     -1.17e-005          2308    0    -65
    -5    71.718    2126.915    -0.000214427    -426.324    2.389    4.903    6.785    0    0.535    0    11.752    16.618    9.137     -2.785e-006         -4.157     -5.557e-006         2308    0    -65
    -5    11.209    2240.149     -1.97612e-05        -534.724    0.092    0.142    0.212     1.071e-006          0.01    0    2.565    2.667    0.264     1.056e-006          -0.347     -1.04e-007          2308    0    -65
    -5    0.000836429    2117.958    0.186    -594.728     2.14e-006            5.616e-009           2.146e-006           -5.303e-010          2.897e-010           4.956e-011           2.369e-004           2.649e-004           3.235e-005           2.905e-008           -8.42e-005           8.25e-008           2308    0    -65
    0    450.228    2215.805    -0.000211485    -227.425    30.18    68.668    84.071     5.421e-020          0.611     -3.388e-021         42.057    84.373    87.897     -8.778e-006         -6.131     -1.547e-005         2308    0    -65
    0    319.665    2219.234    -0.000184217    -288.221    18.535    43.997    56.19    0    0.384    0    34.463    62.444    58.709     -5.227e-006         -5.95     -1.314e-005         2308    0    -65
    0    189.527    2226.511    -0.000182737    -353.689    9.011    21.754    28.699    0    0.156    0    24.807    38.808    29.958     -2.822e-006         -4.302     -9.998e-006         2308    0    -65
    0    73.43    2235.887     2.36423e-05         -429.537    2.375    5.155    7.094    0    0.046    0    12.133    15.295    7.476     1.252e-007          -1.885     6.329e-007          2308    0    -65
    0    12.696    2259.476     -8.86325e-06        -529.639    0.108    0.171    0.252     1.058e-006           -5.432e-006         0    2.849    2.942    0.282     1.053e-006          -0.286     -5.229e-008         2308    0    -65
    0    0.018    2260.529    0.256    -595.226     3.819e-005           7.653e-005           1.147e-004           7.288e-007           4.921e-009           1.79e-009           0.005    0.005     1.56e-004            9.514e-007           -4.613e-004          2.489e-006          2308    0    -65
    5    449.977    2250.039    -0.000218848    -226.042    30.389    68.13    83.209    0    -2.539    0    42.059    81.312    84.721     -5.708e-006         -6.739     -1.586e-005         2308    0    -65
    5    315.838    2268.727    -0.000196428    -287.895    18.399    42.441    54.265    0    -1.937    0    34.09    58.619    54.753     -2.436e-006         -4.702     -1.383e-005         2308    0    -65
    5    183.904    2303.12    -0.000166725    -353.48    8.809    19.843    26.462    0    -1.229    0    24.114    35.152    26.466     -1.496e-007         -1.488     -8.845e-006         2308    0    -65
    5    70.146    2346.242    -0.000180325    -427.69    2.253    4.583    6.343    0    -0.435    0    11.48    13.913    6.446     4.837e-007          0.538     -4.588e-006         2308    0    -65
    5    11.486    2278.791     -1.6866e-05         -533.599    0.095    0.148    0.22     1.043e-006          -0.01    0    2.617    2.68    0.229     1.038e-006          -0.167     -9.078e-008         2308    0    -65
    5    0.000860644    2400.98    -0.035    -594.723     2.198e-006           5.972e-009           2.204e-006           -1.556e-010          -3.092e-010          -8.034e-012          2.437e-004           2.489e-004           9.645e-006           2.646e-009           4.239e-005           -1.597e-008         2308    0    -65
    10    449.824    2284.702    -0.000263452    -221.544    31.117    67.027    81.182    0    -5.57     3.388e-021          42.14    78.294    81.426     -2.761e-006         -7.211     -1.855e-005         2308    0    -65
    10    312.721    2318.577    -0.000255033    -282.881    18.745    40.022    51.16     5.421e-020          -3.996     -6.776e-021         33.59    54.902    51.195     8.435e-007          -3.276     -1.738e-005         2308    0    -65
    10    181.8    2371.873    -0.000241937    -345.724    9.071    17.884    24.188    0    -2.279    0    23.398    32.953    24.93     2.809e-006          0.981     -1.235e-005         2308    0    -65
    10    72.472    2436.491    -0.000263384    -413.84    2.521    4.362    6.16    0    -0.815    0    11.34    14.377    7.357     2.453e-006          2.433     -6.659e-006         2308    0    -65
    10    11.142    2318.58     -2.95897e-05        -529.241    0.11    0.202    0.277     1.017e-006          -0.038    0    2.511    2.605    0.278     1.02e-006           0.017     -1.531e-007         2308    0    -65
    10    0.000281455    2403.245    0.01    -594.738     6.267e-007           3.403e-010           6.27e-007            2.728e-012           -3.758e-011          8.517e-013           7.961e-005           8.154e-005           3.18e-006            -2.763e-010          1.42e-005            1.553e-009          2308    0    -65
    15    450.329    2319.591    -0.000313238    -213.559    32.419    65.466    78.122    0    -8.343     6.776e-021          42.357    75.466    78.183     1.635e-006          -7.567     -2.096e-005         2308    0    -65
    15    311.902    2366.464    -0.000316727    -272.718    19.632    37.358    47.598     -2.711e-020         -5.671     3.388e-021          33.089    51.882    48.665     5.776e-006          -1.883     -2.052e-005         2308    0    -65
    15    183.931    2429.2    -0.000326775    -331.734    9.749    16.381    22.433    0    -3.051    0    22.836    32.169    25.135     7.285e-006          2.895     -1.603e-005         2308    0    -65
    15    79.793    2496.538    -0.000344145    -393.804    3.131    4.625    6.662    0    -1.16    0    11.758    16.088    9.498     5.177e-006          3.787     -9.029e-006         2308    0    -65
    15    14.793    2439.672     -3.15455e-05        -491.882    0.27    0.612    0.75     9.411e-007          -0.175    0    2.966    3.564    1.006     1.003e-006          0.656     -1.992e-007         2308    0    -65
    15    0.000346205    2403.542    0.008    -594.617     7.587e-007           3.626e-010           7.591e-007           2.884e-012           -6.419e-011          1.099e-012           9.787e-005           1.003e-004           3.919e-006           -2.576e-010          1.752e-005           1.445e-009          2308    0    -65
    ];


% 由于提供的原始数据没有网格化，因此采用scatteredInterpolant函数对所有数据进行网格化处理

% 俯仰角
db.payload.theta = [-5,0,5,10,15];
% 质量
db.payload.mass = [0,15,80,185,315,450];

% 构建网格化插值表
[itheta, imass] = meshgrid(db.payload.theta, db.payload.mass);
for i = 1 : 3
    F = scatteredInterpolant (tmp(:,1),tmp(:,2), tmp(:,i+2));
    db.payload.cog(:,:,i) = F(itheta, imass) / 1000; % 单位转为m
end
for i = 1 : 6
    F = scatteredInterpolant (tmp(:,1),tmp(:,2), tmp(:,i+5));
    db.payload.inertia(:,:,i) = F(itheta, imass);
end

clear tmp F